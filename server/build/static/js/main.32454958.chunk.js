(this["webpackJsonpkide-stonks"]=this["webpackJsonpkide-stonks"]||[]).push([[0],{131:function(e,t,n){},132:function(e,t,n){},143:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(100),i=n.n(a),c=(n(131),n(14)),s=(n(132),n(227)),l=n(229),u=n(230),d=n(221),p=n(2),x=function(e){var t=e.setUser,n=(e.setMessage,e.setError),o=e.user,r=(e.setOpenMessageNotification,e.setOpenErrorNotification);return Object(p.jsx)(s.a,{elevation:0,sx:{backgroundColor:"white"},children:Object(p.jsxs)(l.a,{sx:{background:"#212121"},children:[Object(p.jsx)(u.a,{variant:"h5",noWrap:!0,component:"div",sx:{flexGrow:1,color:"white"},children:"KideStonks"}),null===o?null:Object(p.jsx)(d.a,{sx:{position:"absolute",color:"white",fontWeight:700,":hover":{backgroundColor:"#2a0062",color:"white"}},size:"small",onClick:function(){return function(){try{window.localStorage.clear(),window.location.reload(!0),fetch.setToken(""),t("")}catch(e){r(!0),n("Logged out."),setTimeout((function(){n(null)}),6e3)}}()},variant:"text",children:"LOGOUT"})]})})},b=n(23),f=n(31),j=n(231),h=n(214),m=n(218),O=n(51),g="https://api.kide.app/api",v=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("".concat(g,"/products?city=").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("".concat(g,"/products/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t,n,o){var r,a,i;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",body:r={toCreate:[{inventoryId:t,quantity:o,productVariantUserForm:null}]},json:!0,headers:{Authorization:"Bearer ".concat(n)}},e.next=4,O.a.post("".concat(g,"/reservations"),r,a,{});case 4:return i=e.sent,console.log(i.data),e.abrupt("return",i.data);case 7:case"end":return e.stop()}}),e)})));return function(t,n,o){return e.apply(this,arguments)}}(),y={fetchEvents:v,fetchEvent:w,fetchTicket:k,setToken:function(e){"Bearer ".concat(e)}},S=function(e){var t=e.city,n=e.setCity,o=(e.events,e.setEvents),r=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.fetchEvents(t);case 2:n=e.sent,o(n.model);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(j.a,{component:"form",sx:{"& .MuiTextField-root":{m:0,width:"25ch"}},noValidate:!0,autoComplete:"off",children:Object(p.jsx)("div",{children:Object(p.jsx)(h.a,{id:"outlined-select-currency",select:!0,label:"Kaupunki",color:"secondary",value:t,onChange:function(e){n(e.target.value)},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#2a0062",border:"2px solid #2a0062"},"&:hover fieldset":{borderColor:"#2a0062",border:"3px solid #2a0062"},"&.Mui-focused fieldset":{borderColor:"#2a0062",border:"3px solid #2a0062"},"&.Mui-focused":{color:"white"},"&.Mui-root":{color:"white"}}},children:["Joensuu","Kuopio","Pori","Tampere","Helsinki"].map((function(e){return Object(p.jsx)(m.a,{value:e,onClick:function(){return r(e)},children:Object.values(e)},e)}))})})})},M=n(222),T=function(e){var t=e.event,n=e.setEvent,o=e.setEventInfo,r=e.events;return Object(p.jsx)("div",{className:"event-menu",children:Object(p.jsx)(j.a,{component:"form",sx:{"& .MuiTextField-root":{width:"25ch",margin:"10px 0px 10px auto"}},noValidate:!0,autoComplete:"off",children:Object(p.jsx)("div",{children:Object(p.jsx)(h.a,{id:"outlined-select-currency",select:!0,label:"Tapahtuma",color:"secondary",value:t,onChange:function(e){n(e.target.value)},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#2a0062",border:"2px solid #2a0062"},"&:hover fieldset":{borderColor:"#2a0062",border:"3px solid #2a0062"},"&.Mui-focused fieldset":{borderColor:"#2a0062",border:"3px solid #2a0062"},"&.MuiInputLabel-root":{color:"white"},"&.MuiFormLabel-root":{color:"white"}}},children:r.sort((function(e,t){return t.timeUntilSalesStart-e.timeUntilSalesStart})).filter((function(e){return 1===e.productType})).map((function(e){return Object(p.jsxs)(m.a,{value:e.name,onClick:function(){return t=e.id,void y.fetchEvent(t).then((function(e){o(e.model)}));var t},sx:{width:500,whiteSpace:"normal"},children:[e.name,Object(p.jsx)(j.a,{sx:{margin:"0px 0px 0px auto",pl:2},children:0!==e.availability?Object(p.jsx)(M.a,{label:"".concat(e.availability," kpl"),color:"success",variant:"outlined"}):Object(p.jsx)(M.a,{label:"".concat(e.availability," kpl"),color:"error",variant:"outlined"})})]},e.name)}))})})})})},C=function(e){var t=e.setToken;return Object(p.jsx)(j.a,{component:"form",sx:{"& .MuiTextField-root":{width:"25ch",color:"white"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#2a0062"},"&:hover fieldset":{borderColor:"#2a0062"},"&.Mui-focused fieldset":{borderColor:"#2a0062"}}},noValidate:!0,autoComplete:"off",children:Object(p.jsx)("div",{children:Object(p.jsx)(h.a,{value:localStorage.getItem("kideToken"),id:"outlined-helperText",placeholder:"Sy\xf6t\xe4",label:"Token",color:"secondary",sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#2a0062",border:"2px solid #2a0062"},"&:hover fieldset":{borderColor:"#2a0062",border:"3px solid #2a0062"},"&.Mui-focused fieldset":{borderColor:"#2a0062",border:"3px solid #2a0062"},"&.MuiFormLabel-root-MuiInputLabel-root":{color:"white"},"&.Mui-focused":{color:"white"},"&.Mui-root":{color:"white"}}},onChange:function(e){t(e.target.value),window.localStorage.setItem("kideToken",e.target.value)}})})})},E=n(219),I=n(232),N=function(e){var t=e.event,n=e.token,r=e.setMessage,a=e.setError,i=e.setOpenErrorNotification,s=e.setOpenMessageNotification,l=e.setEventInfo,u=Object(o.useState)(!1),d=Object(c.a)(u,2),x=d[0],b=d[1];Object(o.useRef)(!0),Object(o.useRef)();Object(o.useEffect)((function(){var e;return x&&(e=setInterval((function(){f()}),1e3)),function(){return clearInterval(e)}}),[x]);var f=function(){n||(i(!0),a("Token puuttuu."),setTimeout((function(){a("")}),6e3));try{0===t.variants.length&&(y.fetchEvent(t.product.id).then((function(e){l(e.model)})),i(!0),a("Myynti ei ole viel\xe4 alkanut."),setTimeout((function(){a("")}),6e3)),t.variants.map((function(e){return y.fetchTicket(e.inventoryId,n,e.productVariantMaximumReservableQuantity).then((function(t){s(!0),r("Napattiin '".concat(e.name,"' lippu.")),setTimeout((function(){r(""),s(!1)}),6e3)})).catch((function(t){401===t.response.status&&(i(!0),a("Token v\xe4\xe4rin tai puutteellinen. Anna token ilman Bearer-liitett\xe4."),setTimeout((function(){a("")}),6e3)),400===t.response.status&&(i(!0),a("Lippua '".concat(e.name,"' ei saatavilla.")),setTimeout((function(){a(""),i(!1)}),6e3))}))}))}catch(e){i(!0),a("Odottamaton virhe. ".concat(e)),setTimeout((function(){a("")}),6e3)}};return Object(p.jsx)(j.a,{children:Object(p.jsxs)(j.a,{sx:{"& > button":{m:3}},children:[Object(p.jsx)(E.a,{onClick:function(){f()},variant:"contained",size:"medium",sx:{color:"white",backgroundColor:"#2a0062",minWidth:"6rem",minHeight:"3rem",":hover":{background:"#2a0050"}},children:"OSTA"}),Object(p.jsx)(I.a,{value:"check",size:"medium",color:"standard",onClick:function(){b(!x)},sx:{minWidth:"6rem",minHeight:"2rem",color:"white",border:"1x solid #2a0062",boxSizing:"border-box"},children:x?"LOPETA":"LOOP"})]})})},A=n(226),F=n(90),L=n(211),U=n(223),W=n(224),D=n(109),z=n(225),P=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B={login:P},H=function(e){return Object(p.jsxs)(u.a,Object(F.a)(Object(F.a)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["KideStonks is behind login to prevent mass abuse :D. Copyright \xa9 ",Object(p.jsx)(U.a,{color:"inherit",href:"https://github.com/paakkis",children:"paakkis"})," ",(new Date).getFullYear(),"."]}))},V=Object(D.a)({typography:{allVariants:{fontFamily:"Roboto Mono",textTransform:"none",fontSize:16},h5:{color:"white"}},root:{"&. MuiFormLabel-root":{color:"white",background:"#212121"}}}),J=function(e){var t=e.setMessage,n=e.setError,r=e.setUser,a=e.setOpenMessageNotification,i=e.setOpenErrorNotification,s=Object(o.useState)(""),l=Object(c.a)(s,2),x=l[0],m=l[1],O=Object(o.useState)(""),g=Object(c.a)(O,2),v=g[0],w=g[1],k=function(){var e=Object(f.a)(Object(b.a)().mark((function e(o){var c;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.preventDefault(),e.prev=1,e.next=4,B.login({username:x,password:v});case 4:c=e.sent,window.localStorage.setItem("loggedStonkuser",JSON.stringify(c)),y.setToken(c.token),r(c),console.log(c),m(""),w(""),a(!0),t("Logged in as ".concat(c.name)),setTimeout((function(){a(!1),t(null)}),6e3),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(1),i(!0),n("Wrong username or password."),setTimeout((function(){i(!1),n(null)}),6e3);case 21:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(z.a,{theme:V,children:Object(p.jsxs)(W.a,{component:"main",maxWidth:"xs",sx:{display:"flex",flexDirection:"column",justifyContent:"center",margin:"auto !important",alignItems:"center"},children:[Object(p.jsx)(L.a,{}),Object(p.jsxs)(j.a,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(p.jsx)(u.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(p.jsxs)(j.a,{component:"form",onSubmit:k,noValidate:!0,sx:{mt:1},children:[Object(p.jsx)(h.a,{margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",autoFocus:!0,value:x,onChange:function(e){var t=e.target;return m(t.value)}}),Object(p.jsx)(h.a,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",value:v,onChange:function(e){var t=e.target;return w(t.value)}}),Object(p.jsx)(d.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"Sign In"})]})]}),Object(p.jsx)(H,{sx:{mt:8,mb:4}})]})})},R=n(212),K=n(217),q=n(215),Y=function(e){var t=e.message,n=e.error,o=e.openMessageNotification,r=e.openErrorNotification,a=e.setOpenMessageNotification,i=e.setOpenErrorNotification,c=function(e,t){"clickaway"!==t&&i(!1)},s=function(e,t){"clickaway"!==t&&a(!1)};return Object(p.jsxs)(R.a,{spacing:2,sx:{width:"100%"},children:[Object(p.jsx)(K.a,{open:r,autoHideDuration:6e3,onClose:c,children:n&&Object(p.jsx)(q.a,{onClose:c,severity:"error",sx:{width:"100%"},children:n})}),Object(p.jsx)(K.a,{open:o,autoHideDuration:6e3,onClose:s,children:t&&Object(p.jsx)(q.a,{onClose:s,severity:"success",sx:{width:"100%"},children:t})})]})},G=n(234),Q=n(233),X=n(213),Z=n(235),$=n(108),_=n.n($),ee=function(e){var t=e.event;var n=new Date(t.product.dateActualFrom);return Object(p.jsxs)(A.a,{sx:{maxWidth:400,margin:"auto",marginTop:"20px",background:"#262828",boxShadow:"rgba(0, 0, 0, 0.16) 0px 10px 36px 0px, rgba(0, 0, 0, 0.06) 0px 0px 0px 1px"},children:[Object(p.jsx)(Q.a,{component:"img",height:"140",image:"https://portalvhdsp62n0yt356llm.blob.core.windows.net/bailataan-mediaitems/".concat(t.product.mediaFilename),alt:"Tapahtuman kuva",sx:{objectFit:"fill"}}),Object(p.jsxs)(G.a,{sx:{textAlign:"left",display:"flex",flexDirection:"column",gap:".5rem",padding:3,paddingBottom:0},children:[Object(p.jsx)(u.a,{gutterBottom:!0,variant:"h2",component:"div",sx:{color:"#efefef",textAlign:"center"},children:t.product.name}),Object(p.jsx)(X.a,{sx:{border:"2px solid #2a0062",width:"100%",alignSelf:"center"}}),Object(p.jsxs)(u.a,{component:"div",sx:{color:"#efefef",paddingTop:2},children:["Aika: ",n.toLocaleString()]}),Object(p.jsxs)(u.a,{component:"div",sx:{color:"#efefef"},children:["Osoite: ",t.product.place,", ",t.product.streetAddress]}),Object(p.jsxs)(u.a,{component:"div",sx:{color:"#efefef"},children:["J\xe4rjest\xe4j\xe4: ",t.company.name]})]}),Object(p.jsxs)(G.a,{sx:{textAlign:"left",display:"flex",flexDirection:"column",gap:".5rem",padding:3},children:[Object(p.jsx)(u.a,{gutterBottom:!0,variant:"h2",sx:{color:"#efefef",textAlign:"center"},children:"LIPPUTYYPIT"}),Object(p.jsx)(X.a,{sx:{border:"2px solid #2a0062",width:"100%",alignSelf:"center"}}),0===t.product.timeUntilSalesStart?t.variants.map((function(e){return Object(p.jsxs)(A.a,{sx:{width:"100%",maxHeight:100,margin:"auto",marginTop:"10px",textAlign:"left",background:"#262828",padding:1},children:[Object(p.jsx)(u.a,{gutterBottom:!0,variant:"h7",component:"div",sx:{textAlign:"left",whiteSpace:"normal",margin:"7px 7px 7px 7px",fontWeight:500,color:"white"},children:e.name}),Object(p.jsxs)(j.a,{sx:{textAlign:"left",whiteSpace:"normal",margin:"7px 7px 7px 7px"},children:[0!==e.availability?Object(p.jsx)(M.a,{sx:{margin:"0px 7px 0px 0px"},label:"".concat(e.availability," %"),color:"success",variant:"outlined",size:"small"}):Object(p.jsx)(M.a,{sx:{margin:"0px 7px 0px 0px"},label:"".concat(e.availability," %"),color:"error",variant:"outlined",size:"small"}),Object(p.jsx)(M.a,{label:"".concat(e.pricePerItem/100," \u20ac"),color:"warning",variant:"outlined",size:"small"})]})]})})):Object(p.jsx)(A.a,{sx:{maxWidth:380,maxHeight:100,margin:"auto",marginTop:"10px",textAlign:"left",background:"#262828",padding:2},children:Object(p.jsxs)(u.a,{gutterBottom:!0,variant:"h7",component:"div",sx:{textAlign:"left",whiteSpace:"normal",margin:"7px 7px 7px 7px",fontWeight:500,color:"#efefef"},children:["Myynti alkaa ",function(e){e=Number(e);var t=Math.floor(e/86400),n=Math.floor(e%86400/3600),o=Math.floor(e%3600/60),r=Math.floor(e%60);return(t>0?t+(1===t?" p\xe4iv\xe4, ":" p\xe4iv\xe4n, "):"")+(n>0?n+" tunnin, ":"")+(o>0?o+" minuutin, ":"")+(r>0?r+" sekunnin":"")}(t.product.timeUntilSalesStart)," kuluttua."]})})]}),Object(p.jsx)(Z.a,{sx:{textAlign:"left",display:"flex",flexDirection:"column",gap:".5rem",padding:2},children:Object(p.jsx)(d.a,{size:"small",sx:{color:"white",marginTop:"10px"},endIcon:Object(p.jsx)(_.a,{}),href:"https://kide.app/events/".concat(t.product.id),children:"TAPAHTUMAN SIVULLE"})})]})},te=function(){var e=Object(o.useState)(""),t=Object(c.a)(e,2),n=t[0],r=t[1],a=Object(o.useState)(""),i=Object(c.a)(a,2),s=i[0],l=i[1],u=Object(o.useState)(""),d=Object(c.a)(u,2),b=d[0],f=d[1],j=Object(o.useState)(null),h=Object(c.a)(j,2),m=h[0],O=h[1],g=Object(o.useState)([]),v=Object(c.a)(g,2),w=v[0],k=v[1],M=Object(o.useState)(null),E=Object(c.a)(M,2),I=E[0],F=E[1],L=Object(o.useState)(null),U=Object(c.a)(L,2),W=U[0],P=U[1],B=Object(o.useState)(null),H=Object(c.a)(B,2),V=H[0],R=H[1],K=Object(o.useState)(!1),q=Object(c.a)(K,2),G=q[0],Q=q[1],X=Object(o.useState)(!1),Z=Object(c.a)(X,2),$=Z[0],_=Z[1];if(Object(o.useEffect)((function(){var e=window.localStorage.getItem("loggedStonkuser");if(e){var t=JSON.parse(e);R(t),y.setToken(t.token)}f(localStorage.getItem("kideToken"))}),[]),null===V)return Object(p.jsx)(J,{setMessage:F,setError:P,setOpenMessageNotification:_,setOpenErrorNotification:Q,setUser:R});var te=Object(D.a)({typography:{allVariants:{fontFamily:"Roboto Mono",textTransform:"none",fontSize:16},h5:{color:"white"}},root:{"&. MuiFormLabel-root":{color:"white"}}});return Object(p.jsx)(z.a,{theme:te,children:Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(Y,{message:I,error:W,openErrorNotification:G,setOpenErrorNotification:Q,openMessageNotification:$,setOpenMessageNotification:_}),Object(p.jsx)(x,{setMessage:F,setError:P,setUser:R,setOpenMessageNotification:_,setOpenErrorNotification:Q,user:V}),Object(p.jsxs)(A.a,{sx:{width:400,minHeight:400,margin:"auto",boxShadow:"rgba(0, 0, 0, 0.16) 0px 10px 36px 0px, rgba(0, 0, 0, 0.06) 0px 0px 0px 1px",background:"#262828",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(p.jsx)(S,{setCity:r,city:n,setEvents:k}),Object(p.jsx)(T,{setEvent:l,events:w,event:s,setEventInfo:O}),Object(p.jsx)(C,{setToken:f}),Object(p.jsx)(N,{event:m,setMessage:F,setError:P,setOpenMessageNotification:_,setOpenErrorNotification:Q,token:b,setEventInfo:O})]}),null===m?Object(p.jsx)(p.Fragment,{}):Object(p.jsx)(ee,{event:m})]})})};i.a.createRoot(document.getElementById("root")).render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(te,{})}))}},[[143,1,2]]]);
//# sourceMappingURL=main.32454958.chunk.js.map